apiVersion: v1
kind: Secret
metadata:
  name: pull-secret
  namespace: openshift-config
type: kubernetes.io/dockerconfigjson
data:
  .dockerconfigjson: >-
    {{
      (
        ocp_pull_secret.resources[0].data['.dockerconfigjson']
        | b64decode
        | from_json
        | combine({
            'auths': (
              (
                ocp_pull_secret.resources[0].data['.dockerconfigjson']
                | b64decode
                | from_json
              ).auths
              | combine(trusted_registries)
            )
          })
        | to_nice_json
        | b64encode
      )
    }}
